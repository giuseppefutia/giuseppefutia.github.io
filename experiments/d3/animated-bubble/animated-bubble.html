<!DOCTYPE html>
<html class="ocks-org do-not-copy">
<meta charset="utf-8">
<title>Giuseppe Futia's Website</title>
<style>

</style>
<body>

<p id="chart">

<script src="http://d3js.org/d3.v2.min.js?2.9.1"></script>
<script>
/*
Link utili: 
- http://vallandingham.me/gates_bubbles/, view-source:http://vallandingham.me/gates_bubbles/, http://vallandingham.me/gates_bubbles/coffee/vis.coffee
- http://www.nytimes.com/interactive/2012/02/13/us/politics/2013-budget-proposal-graphic.html?_r=0, view-source:http://www.nytimes.com/interactive/2012/02/13/us/politics/2013-budget-proposal-graphic.html?_r=0
*/

var vis, nodes, force, circles;

// used when setting up force and moving around nodes
var layoutGravity = -0.01
var damper = 0.1

var margin = {top: 1, right: 1, bottom: 6, left: 1},
    width = 960 - margin.left - margin.right,
    height = 400 - margin.top - margin.bottom;
    color = d3.scale.category20c();
    outerRadius = 120;
    innerRadius = outerRadius * .6;

var center = {x: width/2, y: height/2}

var data = [
    {"id": "Creative Commons", "value": 50, "topic": "topic1"},
    {"id": "3D Animation", "value": 30, "topic": "topic2"},
    {"id": "Open Data", "value": 20, "topic": "topic3"}
    ];

var areas = {
    "topic1": {x: width / 3, y: height / 2},
    "topic2": {x: width / 2, y: height / 2},
    "topic3": {x: 2 * width / 3, y: height / 2}
    };

var max_amount = d3.max(data, function (d) {return d.value});
var radius_scale = d3.scale.pow().exponent(0.5).domain([0, max_amount]).range([2, 85])


createNodes();
//createVis;

function createNodes () {
    nodes = new Array();
    data.forEach(function (d) {
        var node = {
             "id": d.id,
             "value": d.value,
             "group": d.topic,
             x: Math.random() * 900,
             y: Math.random() * 800
        };
        nodes.push(node);
    });
    // TODO: check if sort on nodes is necessary
} 

var vis = d3.select("#chart").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .attr("id", "svg_vis")

var circles = vis.selectAll("circle")
    .data(nodes, function (d) {
        return d.id;
    });

// Used because we need 'this' in the mouse callbacks

var that = this;
circles.enter().append("circle")
    .attr("r", 0)
    .attr("fill", function (d, i) {
      return color(i);
    })
    .on("mouseover", function (d, i) {
        //TODO
        //that.showDetails(d, i, this);
    })
    .on("mouseout", function (d, i) {
        //TODO
        //that.hideDetails(d, i, this);
    });

circles.transition().duration(2000).attr("r", function (d) { return d.value});

// TODO: Understand what is charge


function charge () {
    if (d.value < 0) {
        return 0
    } else {
        return -Math.pow(d.radius,2.0)/8 
    }
}

function start () {
    var that = this;
    that = d3.layout.force()
        .nodes(nodes)
        .size(width, height)
}

var displayAll = function () {
    var that = this;
    this.force
        .gravity(layoutGravity)
        .charge(that.charge)
        .friction(0.9)
        .on("tick", function (e) { 
             circles.each(that.moveTowardsCenter(e.alpha))
             .attr("cx", function (d) { return d.x} )
             .attr("cy", function (d) { return d.y})
        });

}
    start();
displayAll();
/*
var moveTowardsCenter()
*/

        
</script>
























